@startuml FLICKS

title FLICKS Domain
' ===============================================================
' === HECHO POR:
' === Qinrui Chen
' === Noelia Almeida Ibányez
' === Sebastián Ayala García
' === Sandra Moya del Amo
' ===============================================================

skinparam packageStyle rectangle
skinparam classAttributeIconSize 0
skinparam backgroundColor #FEFEFE
skinparam class {
  BackgroundColor #FFFCEB
  BorderColor #B0A060
}

skinparam enum {
  BackgroundColor #a9ff93ff
  BorderColor #000000
}

' Los id Long de las clases  son Autogenerated en OOH4RIA 

package "FLICKS" {
  ' ========================================
  ' ENUMS
  ' ========================================
  enum TipoNotificacion {
    likeResenya : 1
    reporte : 2
    anuncio : 3
    otro : 4
  }

  enum TipoLista {
    vista : 1
    pendiente : 2
    meGusta : 3
    otra : 4
  }

  enum EstadoReporte {
    pendiente : 1
    resuelto : 2
    rechazado : 3
  }

  ' ========================================
  ' CLASES
  ' ========================================

  class Usuario {
    - Id : Long
    - Nombre : String
    - Email : String
    - FotoPerfil : String?    ' opcional en el EN
    - Biografia : String?     ' opcional en el EN
    - ModoBlancoYNegro : Boolean
    - Contrasena : String
    + New()
    + Modify()
    + Destroy()
    + ReadAll()
    + ReadId()
    + CrearResenaActualizarVM()
    + ModoBlancoYN()
    + Login()
  }

  class Administrador {
    - Id : Long
    - Nombre : String
    - Email : String
    - Contrasena : String
    + New()
    + Modify()
    + Login()
    + Destroy()
    + ReadAll()
    + ReadId()
    + ResolverReporteEnviarNotificacion()
  }

  class Pelicula {
    - Id : Long
    - Titulo : String
    - TituloOriginal : String
    - Anyo : Long?            ' nullable en el EN
    - Duracion : Long?        ' nullable en el EN
    - Pais : String
    - Director : String
    - Genero : String
    - Sinopsis : String
    - ValoracionMedia : Decimal? ' nullable en el EN
    + New()
    + Modify()
    + Destroy()
    + ReadAll()
    + ReadId()
    + ReadFilterGenero()
    + ReadFilterValoracion()
    + ReadFilterAnyo()
    + ReadFilterTitulo()
    + ContarResenas()
    + CalcularValoracionMedia()
  }

  class Resena {
    - Id : Long
    - Valoracion : Decimal
    - Comentario : String
    - FechaPublicacion : DateTime
    + New()
    + Modify()
    + Destroy()
    + ReadAll()
    + ReadId()
    + ReadFilterUsuario()
    + ReadFilterValoracion()
    + ReadFilterByPelicula()
    + Crear(valoracion : Decimal, comentario : String, fechaPublicacion : DateTime)
    + Modificar(id : Long, valoracion : Decimal, comentario : String)
  }

  class Lista {
    - Id : Long
    - Nombre : String
    - Tipo : TipoLista
    - Peliculas : List<Pelicula>
    - Creador : Usuario
    + New()
    + Modify()
    + Destroy()
    + ReadAll()
    + ReadId()
    + AnyadirPelicula()
  }

  class Reporte {
    - Id : Long
    - Motivo : String
    - Estado : EstadoReporte
    - Fecha : DateTime
    - Autor : Usuario
    - SobreResena : Resena
    + New()
    + Modify()
    + Destroy()
    + ReadAll()
    + ReadId()
    + ReadFilterEstado()
  }

  class Notificacion {
    - Id : Long
    - Mensaje : String
    - Fecha : DateTime
    - TipoNotificacion : TipoNotificacion
    - IdOrigen : Long?
    - Leida : Boolean
    - FechaLeida : DateTime?
    - Destinatario : Usuario
    + New()
    + Destroy()
    + ReadAll()
    + ReadId()
    + ReadFilterEstado()
    + ReadFilterOrigen()
  }

  class Metrica {
    - Id : Long
    - ValoracionMedia : Double
    - NumeroResenas : Integer
    - AparicionesEnListas : Integer
    - Popularidad : Double
    - Fecha : DateTime
    - Pelicula : Pelicula
    + ReadAll()
    + ReadId()
    + New()
    + Modify()
    + Destroy()
  }

  ' ========================================
  ' RELACIONES
  ' ========================================

  Usuario "1..1" -- "0..*" Resena : crea >
  Usuario "1..*" -- "0..*" Lista : lista >
  Usuario "1..1" -- "0..*" Reporte : envia >
  Usuario "1..1" -- "0..*" Notificacion : notificacion >
  Usuario "1..*" -- "0..1" Metrica : metrica >
  Administrador "1..1" -- "0..*" Pelicula : publica >
  Administrador "1..1" -- "0..*" Reporte : resuelve >
  Lista "0..*" -- "1..*" Pelicula : pelicula >
  Reporte "0..1" -- "1..*" Resena : resena >
  Pelicula "1..1" -- "0..*" Resena : resenas >
}
@enduml
